<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <title>Recipe</title>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
    <div id="recipe" class="container"></div>    
    <footer id="footer"></footer>
    
    <script id="template" type="text/template">
      <div class="mb-4 pb-2 border-bottom">
        <h1>{{name}}</h1>
      
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="/">Home</a></li>
          <li class="breadcrumb-item"><a href="recipes.html">Recipes</a></li>
          <li class="breadcrumb-item active" aria-current="page">{{name}}</li>
        </ol>

        {{#description}}<p>{{.}}</p>{{/description}}
        {{#descriptions}}<p>{{.}}</p>{{/descriptions}}
      </div>

      {{#ingredients.length}}
      <h2>Ingredients</h2>
      <ul>
        {{#ingredients}}<li>{{.}}</li>{{/ingredients}}
      </ul>
      {{/ingredients.length}}

      {{#instructions.length}}
      <h2>Instructions</h2>
      <ol>
        {{#instructions}}<li>{{.}}</li>{{/instructions}}
      </ol>
      {{/instructions.length}}
      
      {{#other}}
      <h3>{{name}}</h3>
      {{#ul.length}}<ul>{{#ul}}<li>{{.}}</li>{{/ul}}</ul>{{/ul.length}}
      {{#ol.length}}<ol>{{#ol}}<li>{{.}}</li>{{/ol}}</ol>{{/ol.length}}
      {{#p}}<p>{{.}}</p>{{/p}}
      {{/other}}

      {{#yield}}<p>Yield: {{.}}</p>{{/yield}}
      {{#source}}<p>Source: {{.}}</p>{{/source}}
    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/2.1.3/mustache.min.js"></script>
    <script src="/js/chamfam.js"></script>
    
    <script type="text/javascript">
      const recipeFile = window.location.search.substring(1);
      const recipeContainer = document.getElementById("recipe");
      const templateElement = document.getElementById("template");
      
      fetch("data/" + recipeFile + ".json")
        .then(response => response.json())
        .then(data => {
          const template = templateElement.innerHTML;
          const output = Mustache.to_html(template, data);
          recipeContainer.innerHTML = output;
          document.title = data.name;
        })
        .catch(error => {
          recipeContainer.innerHTML = `<div class="alert alert-danger">Request Failed: ${error.message}</div>`;
        });
    </script>
  </body>
</html>